import{r as o,j as e,i as A,L as _,o as k}from"../chunks/chunk-gph8HdTZ.js";import"../chunks/chunk-BBHFXXKC.js";/* empty css                      *//* empty css                      */const B=n=>{const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=new Uint32Array(n);return crypto.getRandomValues(a),Array.from(a,c=>s[c%s.length]).join("")},D=n=>new Promise(s=>setTimeout(s,n)),L=()=>{let n=0;const s=1e3;return a=>{const c=Date.now();c-n>s&&(console.error(a),n=c)}},N=L(),P=1048576,O="./data-waste.bin",$="./wastebin.html",W=512,I=3,V=512;function H(){const[n,s]=o.useState({downloadedMB:0,uploadedMB:0,totalMB:0,speedMBps:0,downloadPct:0,uploadPct:0,totalPct:0,status:""}),a=o.useRef(!1),c=o.useRef(0),w=o.useRef(0),j=o.useRef(0),f=o.useRef(!1),b=o.useRef([]),i=o.useRef([]),v=o.useRef(void 0),d=o.useRef({sizeMB:0,threads:8,download:!0,upload:!0}),g=()=>{const t=d.current,r=c.current/P,l=w.current/P,h=r+l,m=t.sizeMB||1/0,u=x=>m===1/0?0:x/m*100,y=(Date.now()-j.current)/1e3,S=y?h/y:0;s(x=>({...x,downloadedMB:r,uploadedMB:l,totalMB:h,speedMBps:S,downloadPct:u(r),uploadPct:u(l),totalPct:u(h)})),t.sizeMB&&h>=t.sizeMB&&a.current&&(p(),s(x=>({...x,status:"Completed"}))),a.current&&y>30&&S<1&&f.current&&t.sizeMB&&s(x=>({...x,status:"Network too slow to waste efficiently"}))},T=o.useCallback(t=>{if(!a.current){if(!t.download&&!t.upload){s(r=>({...r,status:"Select at least one mode"}));return}d.current=t,c.current=0,w.current=0,b.current=[],i.current=[],f.current=!1,j.current=Date.now(),a.current=!0,g(),v.current=setInterval(g,50),t.download&&R(),t.upload&&U()}},[]),p=o.useCallback(()=>{a.current&&(a.current=!1,b.current.forEach(t=>t.abort()),i.current.forEach(t=>t.abort()),v.current&&clearInterval(v.current),s(t=>({...t,status:"Stopped",speedMBps:0})))},[]),R=()=>{const t=d.current.upload?Math.max(1,d.current.threads>>1):d.current.threads;for(let r=0;r<t;r++)C(r)},C=async t=>{const r=new AbortController;for(b.current[t]=r;a.current;){try{const l=await fetch(`${O}?t=${Date.now()}-${Math.random()}`,{headers:{"Accept-Encoding":"identity"},signal:r.signal});f.current=!0;const h=l.body.getReader();for(;a.current;){const{done:m,value:u}=await h.read();if(m)break;c.current+=u.length}}catch(l){N(l)}await D(50)}},U=()=>{const t=d.current.download?Math.max(1,d.current.threads>>1):d.current.threads;for(let r=0;r<t;r++)E(r)},E=async t=>{const r=new AbortController;for(i.current[t]=r;a.current;){try{const l=B(W),h={};let m=0;for(let u=0;u<I;u++){const y=`X-${B(6)}`,S=B(V);h[y]=S,m+=y.length+S.length+2}await fetch(`${$}?w=${l}`,{method:"GET",headers:{"Content-Encoding":"identity",...h},signal:r.signal}).catch(u=>{N(u)}),f.current=!0,w.current+=l.length+m}catch(l){N(l)}await D(30)}};return o.useEffect(()=>p,[p]),{metrics:n,start:T,stop:p,running:a.current}}function F(){const[n,s]=o.useState(!0),[a,c]=o.useState(!0),[w,j]=o.useState(1e4),[f,b]=o.useState(16),{metrics:i,start:v,stop:d,running:g}=H(),T=()=>{if(g){d();return}v({sizeMB:w,threads:f,download:n,upload:a})};return e.jsxs("main",{className:"max-w-md mx-auto p-6 space-y-8 font-sans",children:[e.jsxs("header",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Data Waster"}),e.jsx("p",{className:"text-gray-500",children:"Burn bandwidth for tests or throttling detection."})]}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx(z,{active:n,label:"Download",onClick:()=>s(!n)}),e.jsx(z,{active:a,label:"Upload",onClick:()=>c(!a)})]}),e.jsxs("label",{className:"block mb-4",children:[e.jsx("span",{className:"text-sm mr-2",children:"Target size (MB, 0 = ∞)"}),e.jsx("input",{type:"number",min:0,value:w,onChange:p=>j(Number(p.target.value)),className:"w-28 px-2 py-1 border rounded"})]}),e.jsxs("label",{className:"flex items-center gap-2 mb-8",children:[e.jsx("span",{className:"text-sm",children:"Threads"}),e.jsx("input",{type:"range",min:1,max:32,value:f,onChange:p=>b(Number(p.target.value)),className:"flex-1 accent-blue-600"}),e.jsx("span",{className:"w-6 text-right",children:f})]}),e.jsx("button",{onClick:T,disabled:!n&&!a,className:`w-full py-2 rounded text-white transition
                    ${g?"bg-red-600":"bg-blue-600 disabled:bg-gray-400"}`,children:g?"Stop":"Start"}),e.jsxs("div",{className:"mt-8 space-y-1",children:[e.jsxs("span",{className:"text-xs text-gray-600",children:[i.totalPct.toFixed(1),"%"]}),e.jsx("div",{className:"w-full h-3 bg-gray-200 rounded overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-600 transition-all",style:{width:`${i.totalPct}%`}})})]}),e.jsxs("section",{className:"grid grid-cols-2 gap-4 text-center text-sm mt-6",children:[e.jsx(M,{label:"Downloaded (MB)",value:i.downloadedMB}),e.jsx(M,{label:"Uploaded (MB)",value:i.uploadedMB}),e.jsx(M,{label:"Total (MB)",value:i.totalMB}),e.jsx(M,{label:"Speed (MB/s)",value:i.speedMBps})]}),e.jsx("p",{className:"text-center text-sm text-yellow-600 mt-4 h-5",children:i.status})]})}function z({active:n,label:s,onClick:a}){return e.jsx("button",{onClick:a,className:`px-4 py-2 rounded border border-blue-600 transition
                  ${n?"bg-blue-600 text-white":"text-blue-600"}`,children:s})}function M({label:n,value:s}){return e.jsxs("div",{children:[e.jsx("span",{className:"block text-gray-500",children:n}),e.jsx("span",{className:"font-mono",children:s.toFixed(2)})]})}const G=Object.freeze(Object.defineProperty({__proto__:null,default:F},Symbol.toStringTag,{value:"Module"})),q="Data waster",Q=Object.freeze(Object.defineProperty({__proto__:null,title:q},Symbol.toStringTag,{value:"Module"})),Z={serverOnlyHooks:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:!1}},isClientRuntimeLoaded:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:!0}},onBeforeRenderEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},dataEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},onRenderClient:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/onRenderClient",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:k}},Page:{type:"standard",definedAtData:{filePathToShowToUser:"/src/pages/index/+Page.tsx",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:G}},hydrationCanBeAborted:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/config",fileExportPathToShowToUser:["default","hydrationCanBeAborted"]},valueSerialized:{type:"js-serialized",value:!0}},Layout:{type:"cumulative",definedAtData:[{filePathToShowToUser:"/src/pages/Layout.tsx",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:_}]},title:{type:"standard",definedAtData:{filePathToShowToUser:"/src/pages/index/+title.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:Q}},Loading:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/Loading",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:A}}};export{Z as configValuesSerialized};
